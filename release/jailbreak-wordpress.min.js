/**
* jailbreak-wordpress
 * Breaks themes out of jail.
 *
 * @author Ted Benson and Sarah Scodel
 * @copyright MIT CSAIL Haystack Group 2013
 * @license MIT <http://github.com/webcats/dscrape/blob/master/LICENSE.txt>
 * @link 
 * @module jailbreak-wordpress
 * @version 0.0.1
 */

(function(){typeof Jailbreak=="undefined"&&(Jailbreak={}),Jailbreak.Theme=function(e,t){this.initialize(t),this.contentMap=null,this.sources={},this.mockups={},this.treesheets={},this.stylesheets={},this.javascripts={}},Jailbreak.Theme.prototype.initialize=function(e){},typeof Jailbreak=="undefined"&&(Jailbreak={}),Jailbreak.ContentPage=function(e,t){this.url=null},Jailbreak.ContentMap=function(e){this.initialize(),this.pages=[]},Jailbreak.ContentMap.prototype.initialize=function(){},typeof Jailbreak=="undefined"&&(Jailbreak={}),typeof Jailbreak.Pipeline=="undefined"&&(Jailbreak.Pipeline={}),Jailbreak.Pipeline.FetchPages=function(e,t){this.name="Fetch Pages"},Jailbreak.Pipeline.FetchPages.prototype.run=function(e){},typeof Jailbreak=="undefined"&&(Jailbreak={}),typeof Jailbreak.Pipeline=="undefined"&&(Jailbreak.Pipeline={}),Jailbreak.Pipeline.FetchAssets=function(e){this.name="Fetch Assets"},Jailbreak.Pipeline.FetchAssets.prototype.run=function(e){},typeof Jailbreak=="undefined"&&(Jailbreak={}),typeof Jailbreak.Pipeline=="undefined"&&(Jailbreak.Pipeline={}),Jailbreak.Pipeline.FixAssets=function(e,t){this.name="Fix Assets"},Jailbreak.Pipeline.FixAssets.prototype.run=function(e){},typeof Jailbreak=="undefined"&&(Jailbreak={}),typeof Jailbreak.Pipeline=="undefined"&&(Jailbreak.Pipeline={}),Jailbreak.Pipeline.Pipeline=function(){this.stages=[new Jailbreak.Pipeline.FetchPages,new Jailbreak.Pipeline.FetchAssets]},Jailbreak.Pipeline.Pipeline.prototype.run=function(e){for(var t=0;t<this.stages.length;t++)console.log("[Pipeline] Running Stage: "+this.stages[t].name),this.stages[t].run(e)}}).call(this),fs=require("fs"),path=require("path"),optimist=require("optimist"),printLine=function(e){process.stdout.write(e+"\n")},printError=function(e){process.stderr.write(e+"\n")},BANNER="Usage: jailbreak-wordpress <Workspace> <ThemeName> [ContentMap]",exports.run=function(){var e=optimist.usage(BANNER).argv;if(e._.length<2)return optimist.showHelp(),!1;var t=e._[0],n=e._[1],r=e._[2],i=path.join(t,n);fs.existsSync(t)||fs.mkdirSync(t),fs.existsSync(i)||fs.mkdirSync(i);var s=new Jailbreak.Pipeline.Pipeline,o=new Jailbreak.ContentMap(r),u=new Jailbreak.Theme(n,i,o);s.run(u)};